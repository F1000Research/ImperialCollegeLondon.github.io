<!DOCTYPE html>
<html>
	<head>
		<title>PhyloCanvas</title>

		<meta name="viewport" content="width=device-width" />

		<link rel="stylesheet" href="//brick.a.ssl.fastly.net/Raleway:100,300,400,500,700">
		<link rel="stylesheet" href="/css/phylocanvas.css">
	</head>
	<body>
		<div class="container">
			<h1 class="pageheader"><span class="light">Phylo</span>Canvas <span class="light"> - API</span></h1>
			<nav>
				<ul>
					<li><a href="api.html">API</a></li>
					<li><a href="technical.html">Technical Documentation</a></li>
				</ul>
			</nav>


			<section class="class">
			<h2>PhyloCanvas.Tree</h2>
			<h3>Config Object</h3>
			<p class="note">To be expanded in v 1.3.0</p>
			<dl>
				<dt>history_collapsed - <i>boolean</i></dt>
					<dd>Is the history initially in the collapsed state</dd>

			</dl>

			<h3>Properties</h3>
				<dl>
					<dt>backColour - <i>bool/function (default : false)</i></dt>
						<dd>
						Possible values:
							<ul>
							<li><strong>false</strong> : the branches are all coloured according to Tree.branchColour</li>
							<li><strong>true</strong> : leaves are coloured according to their .colour property. IF all of an Internal branches
								children are of the same colour the branch takes that colour, otherwise it uses Tree.branchColour</li>
							<li><strong>{string:rgba} function(branch)</strong> : the branch colour is determined by the colour returned by the function.
								Ideally the returned colour should be an RGBA value</li>
							</ul>
						</dd>

					<dt>baseNodeSize - <i>integer</i></dt>
						<dd>The radius of a leaf tip if no other size is specified</dd>

					<dt>branchColour - <i>rgba value</i></dt>
						<dd>The normal colour of the branches </dd>

					<dt>branchScalar - <i>double</i></dt>
						<dd>a multiplier for the branch length to produce the best
						possible definition between branch lengths (branchLength * branchScalar =
						drawnLength) </dd>

					<dt>branches - <i>Object/Dictionary</i></dt>
						<dd>An object containing each branch keyed by it's ID. Internal
						branches without IDs are given generated Ids prefixed with 'pcn',
						the root will typically be 'pcn0'</dd>

					<dt>canvas - <i>HTMLCanvasContext</i></dt>
						<dd>the canvas used to draw the tree</dd>

					<dt>canvasEl - <i>HTMLDivElement</i></dt>
						<dd>Slight misnoma for legacy reasons... the element that
						contains PhyloCanvas. Should normally be a block element</dd>

					<dt>contextMenu - <i>PhyloCanvas.ContextMenu</i></dt>
						<dd>A reference to the context menu object that belongs to this instance</dd>

					 <dt>dragging - <i>boolean</i></dt>
							<dd>has the tree been "picked up" AND moved?</dd>

					<dt>drawn - <i>boolean</i></dt>
						<dd>A variable for internal use the records whether
						the pre-render has run (named for legacy reasons)</dd>

					<dt>font - <i>string</i></dt>
						<dd>The font face to use for tree labels</dd>

					<dt>highlightColour - <i>rgba value</i></dt>
						<dd>The colour highlighted branches change to</dd>

					<dt>hightlightWidth - <i>int (default : 5)</i></dt>
						<dd>How much bigger do highlighted nodes/branches get</dd>

					<dt>hoverLabel - <i>boolean</i></dt>
						<dd>If the labels are turned off, and this is true, show
						the node label when hovering over the node tip.</dd>

					<dt>internalNodesSelectable - <i>boolean</i></dt>
						<dd>Can internal nodes be selected, if false, only leaves
						are selectable</dd>

					<dt>lastId - <i>int</i></dt>
						<dd>The last id returned by the id generator</dd>

					<dt>leaves - <i>PhyloCanvas.Branch[]</i></dt>
						<dd>An array of every node without children, the tips
							of the tree </dd>

					<dt>lineWidth - <i>double (default:1.0)</i></dt>
						<dd>The width of the lines that make up the branches, as
						well as the outline of the nodes</dd>

					<dt>maxBranchLength - <i>double, read only</i></dt>
						<dd>The max branchlength from the root of the tree to
							the furthest tip</dd>

					<dt>offsetx/offsety - <i>int</i></dt>
						<dd>The the position of the diagram origin (0,0)
						relative to the centre of the viewer</dd>

					<dt>origBL - <i>Object</i></dt>
						<dd>The original branch lengths, populated when a
							subtree is drawn </dd>

					<dt>origP - <i>Object</i></dt>
						<dd>The original parent of the new root, populated when a
							subtree is drawn </dd>

					<dt>pickedUp - <i>boolean</i></dt>
						<dd>Is the left mouse button being held down over the
							tree</dd>

					<dt>rightClickZoon - <i>boolean (default : true)</i></dt>
						<dd>Enable zooming the tree by dragging with the right mouse button</dd>

					<dt>selectedColour - <i>rgba value</i></dt>
						<dd>The colour the branch and node change to when selected</dd>

					<dt>selectedNodeSizeIncrease - <i>int (default : 0)</i></dt>
						<dd>How much bigger do selected nodes get</dd>

					<dt>showBootstrap - <i>boolean (default:false)</i></dt>
						<dd>Whether or not to show all the bootstrap confidences</dd>

					<dt>showLabels - <i>boolean (default: true)</i></dt>
						<dd>Whether or not to draw all the leaf labels</dd>

					<dt>textSize - <i>integer</i></dt>
						<dd>The size of the branch labels (in px)</dd>

					<dt>treetype - <i>string (default : radial)</i></dt>
						<dd>which branchRenderer to use, supplied renderers are:
							radial, rectangular, circular, diagonal and hierarchy</dd>

					<dt>root - <i>Branch</i></dt>
						<dd>A reference to the root of the tree</dd>

					<dt>unselectOnClickAway - <i>boolean (default : true)</i></dt>
						<dd>Deselect when the user clicks on somewhere on the canvas
						that isn't the tree</dd>

					<dt>selectedNodes - <i>PhyloCanvas.Branch[]</i></dt>
						<dd>An array of the selected branches</dd>

					<dt>zoom - <i>double</i></dt>
						<dd>The current Zoom level</dd>

				</dl>

			<h3>Functions</h3>
			<dl>
				<dt class="code">AJAX(url, method, params, callback, callbackPars, scope, errorCallback)</dt>
					<dd>Make an AJAX call and pass the data returned to the callback. Used in the load method</dd>

				<dt class="code">branchRenderers (collection : function(Tree, Branch, collapsed))</dt>
					<dd>Functions that enable the drawing of different tree structures. Default
					branchRenderers are radial, rectangular, circular, diagonal, hierarchy </dd>

				<dt class="code">load(<i>filename/nwkstring</i>,<i>[tree_name]</i>,<i>[format]</i>)</dt>
					<dd>
						<p>Parse a newick or nexus format string and draw the tree</p></p>
						<h4>Arguments</h4>
						<dl>
							<dt>filename (String)</dt>
							<dd>the name of the file you wish to open via AJAX or the NWK or Nexus String</dd>

							<dt>tree_name (String)</dt>
							<dd>If using nexus format, the name of the tree to draw. But default Phylocanvas picks the first tree</dd>

							<dt>format (nexus|newick)</dt>
							<dd>override the parsing algorithm for the string provided</dd>
						</dl>
					</dd>

				<dt class="code">clicked(event)</dt>
				<dt class="code">dblclicked(even)</dt>
				<dt class="code">drag(even)</dt>
					<dd>
						Event handlers for mouse events on the canvas
					</dd>


				<dt class="code">displayLabels()</dt>
					<dd>
						<p>Show the lables on the tree</p>
					</dd>

				<dt class="code">draw(forcRedraw)</dt>
					<dd>
						draw the tree with the settings provided, forceRedraw causes
						the prerenderer to redraw
					</dd>

				<dt class="code">hideLabels()</dt>
					<dd>
						<p>Hide the lables on the tree</p>

					</dd>

				<dt class="code">setTreeType(<i>type</i>)</dt>
					<dd>
						<p>Hide the lables on the tree</p>
						<h4>Arguments</h4>
						<dl>
							<dt>type (String)</dt>
							<dd>
								<p>the name of the type of tree to change to (rectangular, radial, circular, diagonal, hierarchy)</p>
							</dd>
						</dl>
					</dd>
			</dl>

			<a name="tree-events"><h3>Events</h3></a>
			<p>PhyloCanvas exposes a number of events that allow web pages to change according to activity within PhyoCanvas. The API also exposes a couple of helper methods to enable binding of events to the API.</p>
			<h3>Helper Methods</h3>
			<dl>
				<dt>Tree.on(<i>event name</i>, <i>handler</i>)</dt>
				<dt>Tree.addListener(<i>event name</i>, <i>handler</i>)</dt>
					<dd>add the specified <i>handler</i> to the specified <i>event name</i></dd>
				<!--<dt>TODO : Tree.removeListener/Tree.off</dt>-->
			</dl>

			<h3>Events</h3>
			<dl>
				<dt>loading</dt>
					<dd>Fires when the widget starts loading a file via AJAX</dd>

				<dt>loaded</dt>
					<dd>Fires when a tree has completed loading.</dd>

				<dt>error</dt>
					<dd>
						Fires if an error is encountered by the loading or parsing process
						<h4>Properties</h4>
						<dl>
							<dt>message</dt>
								<dd>The Error message</dd>
						</dl>
					</dd>

				<dt>subtree</dt>
					<dd>
						Fires when the user draws a subtree
						<h4>Properties</h4>
						<dl>
							<dt>node</dt>
								<dd>The id of the node chosen as the new root</dd>
						</dl>
					</dd>

				<dt>typechanged</dt>
					<dd>
						Fires when the tree type is changed
						<h4>Properties</h4>
						<dl>
							<dt>oldType</dt>
								<dd>The name of the type of tree that was being displayed before the type was changed</dd>

							<dt>newType</dt>
								<dd>The name of the type of tree that the view was changed to</dd>
						</dl>
					</dd>

				<dt>selected</dt>
					<dd>
						Fires when the user selectes node(s)
						<h4>Properties</h4>
						<dl>
							<dt>nodes</dt>
								<dd>An Array of the IDs of selected node</dd>
						</dl>
					</dd>


			</dl>
			</section>

			<section name="api-branch">
				<a name="branch"></a>
				<h2>PhyloCanvas.Branch</h2>

				<h3>Properties</h3>
					<dt>branchLength</dt>
						<dd>
							The relative length of the branch as defined in the nwk/nexus string
						</dd>
					<dt>centrex/centrey</dt>
						<dd>
							The position of the end of the node.
						</dd>
					<dt>id</dt>
						<dd>
							The unique identifier for a node, particulary for identifying leaf nodes, this becomes the
							key to <i>Tree.branches</i>
						</dd>
					<dt>label</dt>
						<dd>
							The label shown next to the node. Blank strings will be displayed, if the label is null (default)
							or undefined the ID is displayed instead
						</dd>
					<dt>startx/starty</dt>
						<dd>
							The position of the start of the branch (the parent nodes centrex/centrey)
						</dd>




				<h3>Functions</h3>
					<dt>rotate()</dt>
						<dd>Reverse the order of the nodes immediate children. The reverse function is available in the right-click menu</dd>

			</section>
		</div>
	</body>
</html>
